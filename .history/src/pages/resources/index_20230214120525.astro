---
import { Picture } from "@astrojs/image/components";
import Container from "@components/container.astro";
import Sectionhead from "@components/sectionhead.astro";
import Layout from "@layouts/Layout.astro";
import { getFormattedDate } from "@utils/all";
import { log } from "astro/dist/core/logger/core";
import { getCollection } from "astro:content";
import { useSanityClient, groq } from "astro-sanity";
import imageUrlBuilder from '@sanity/image-url'
const builder = imageUrlBuilder(myConfiguredSanityClient)

const blogEntries = await getCollection("resources");

export async function getFirstBlogPost() {
  const query = groq`*[_type == "brand"]`;
  const firstPost = await useSanityClient().fetch(query);
  console.log(firstPost);
  return firstPost;
}

let brands = await getFirstBlogPost();
---

<Layout title="Resources">
  <Container>
    <Sectionhead>
      <Fragment slot="title">Resources</Fragment>
      <Fragment slot="desc">
        We write about building startups and thoughts going on our mind.
      </Fragment>
    </Sectionhead>
    <main class="mt-16">
      <ul
        role="list"
        className="divide-y divide-gray-200 border-t border-b border-gray-200">
        {
          brands.map((brand, index) => (
            <li key={brand.slug} className="flex py-6 sm:py-10">
              <div className="flex-shrink-0">
                <img
                  src={brand.mainImage.asset.url}
                  className="h-24 w-24 rounded-md object-cover object-center sm:h-48 sm:w-48"
                />
              </div>

              <div className="ml-4 flex flex-1 flex-col justify-between sm:ml-6">
                <div className="relative pr-9 sm:grid sm:grid-cols-2 sm:gap-x-6 sm:pr-0">
                  <div>
                    <div className="flex justify-between">
                      <h3 className="text-sm">
                        <a
                          href=""
                          className="font-medium text-gray-700 hover:text-gray-800">
                          {brand.name}
                        </a>
                      </h3>
                    </div>
                    <div className="mt-1 flex text-sm">
                        {brand.description}
                    </div>
                  </div>
                </div>
              </div>
            </li>
          ))
        }
      </ul>
    </main>
  </Container>
</Layout>
